<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>スライド一覧</title>
  <style>
    body {
      font-family: sans-serif;
    }

#thumbnails {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 16px;
  padding: 16px;
}

.thumb {
  width: 100%;
  height: auto;
  cursor: pointer;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
  transition: transform 0.2s, box-shadow 0.2s;
}

.thumb:hover {
  transform: scale(1.03);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}


    /* モーダルスタイル */
    .modal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .modal-content {
      position: relative;
      width: 90%;
      height: 90%;
      background: #000;
    }

    .modal iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .close-btn {
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 32px;
      color: white;
      cursor: pointer;
    }

    .close-btn:hover {
      color: red;
    }
  </style>
</head>
<body>
  <h1>スライド一覧</h1>
  <div class="thumb-container" id="thumbnails">
    <!-- JavaScriptでサムネイルを生成 -->
  </div>

  <div class="modal" id="slideModal">
    <div class="modal-content">
      <span class="close-btn" id="closeModal">✕</span>
      <iframe id="slideFrame" allowfullscreen></iframe>
    </div>
  </div>

  <script>
    const slides = [
        {
    "title": "パンの日",
    "id": "1Jx6P6pEMuqcurlXefEtw_odsTNbKUxeJZb-VxIMAgVo",
    "pageid": "gc6f59039d_0_14"
  },
  {
    "title": "パン食い競争",
    "id": "1b0c12eKzODJTausJrrUikqG2-E-8FTHiCBQz44J6-38",
    "pageid": "gc6fa3c898_0_28"
  },
    {
    "title": "なぜパンと呼ぶ？",
    "id": "1K0SPEiJsYL_h9lsJRz7vWuf3f-KtA_OGtXYCM_RWDcI",
    "pageid": ""
  }
      // 追加スライドはここに
    ];

    const thumbnails = document.getElementById('thumbnails');
    const modal = document.getElementById('slideModal');
    const slideFrame = document.getElementById('slideFrame');
    const closeModal = document.getElementById('closeModal');

slides.forEach(slide => {
  const img = document.createElement('img');
  img.src = slide.pageid
    ? `https://docs.google.com/presentation/d/${slide.id}/export/jpeg?pageid=${slide.pageid}`
    : `https://docs.google.com/presentation/d/${slide.id}/export/jpeg`; // pageidが無い場合は最初のスライド画像

  img.alt = slide.title;
  img.className = 'thumb';

  img.onclick = () => {
    slideFrame.src = slide.pageid
      ? `https://docs.google.com/presentation/d/${slide.id}/embed?slide=id.${slide.pageid}&rm=minimal`
      : `https://docs.google.com/presentation/d/${slide.id}/embed?rm=minimal`; // pageidが無いときは先頭スライド

    modal.style.display = 'flex';
  };

  thumbnails.appendChild(img);
});


    closeModal.onclick = () => {
      modal.style.display = 'none';
      slideFrame.src = '';  // アンロードしてパフォーマンス向上
    };

    // モーダル外クリックで閉じる（任意）
    modal.onclick = (e) => {
      if (e.target === modal) {
        closeModal.click();
      }
    };
  </script>
</body>
</html>
